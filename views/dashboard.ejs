<h3>Admin Dashboard</h3>
<div class="row g-3 mb-3">
  <div class="col-md-4"><div class="card p-3"><h5>Total Links</h5><p><%= stats.totalLinks %></p></div></div>
  <div class="col-md-4"><div class="card p-3"><h5>Total Clicks</h5><p><%= stats.totalClicks %></p></div></div>
  <div class="col-md-4"><div class="card p-3"><h5>Total Users</h5><p><%= stats.totalUsers %></p></div></div>
</div>

<div class="card p-3 mb-4">
  <h5>Top Countries</h5>
  <canvas id="chartCountries" height="120"></canvas>
</div>

<div class="card p-3">
  <h5>Recent Links</h5>
  <table class="table table-sm">
    <thead><tr><th>Short</th><th>Original</th><th>Clicks</th></tr></thead>
    <tbody>
      <% recent.forEach(r=>{ %>
      <tr>
        <td><a href="/r/<%= r.shortCode %>" target="_blank"><%= r.shortCode %></a></td>
        <td class="text-truncate" style="max-width:480px"><%= r.originalUrl %></td>
        <td><%= r.clicks %></td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>
new Chart(document.getElementById('chartCountries'),{
  type:'doughnut',
  data:{ labels:<%- JSON.stringify(chartLabels) %>, datasets:[{ data:<%- JSON.stringify(chartData) %> }] }
});
</script>
